# D&D 5e 人物卡模板 v2.0 使用说明

## 📋 模板结构概览

新版本模板包含以下8个主要区域：

```
┌─────────────────────────────────────────────────────────────┐
│                    D&D 5e 人物卡 v2.0                       │
├─────────────────────────────────────────────────────────────┤
│ 基础信息  │  战斗数据      │  豁免检定                      │
│ A3:E7     │  F3:I9         │  F11:I17                       │
├───────────┴────────────────┴────────────────────────────────┤
│ 六维属性 (A9:D16)                                           │
│ 力量/敏捷/体质/智力/感知/魅力 + 自动计算调整值               │
├────────────────────────────┬────────────────────────────────┤
│ 子职特性 (A18:F35)         │ 种族特性 (H18:L35)             │
│ 勇士/战斗大师/奥法骑士     │ 黑暗视觉/特性1/特性2           │
├────────────────────────────┴────────────────────────────────┤
│ 职业基础特性 (A37:F55)     │ 装备 (H37:L45)                 │
│ 1-20级战士特性             │ 武器/护甲/盾牌                │
└─────────────────────────────────────────────────────────────┘
```

---

## 📝 各区域详细说明

### 1. 基础信息区 (A3-E7)

| 单元格 | 内容 | 示例 |
|--------|------|------|
| A3/B3 | 角色名 | 断牙·萨尔坦 |
| C3/D3 | 种族 | 半兽人 |
| A4/B4 | 玩家名 | 森林小毛熊 |
| C4/D4 | 职业 | 战士 |
| A5/B5 | 等级 | 1 |
| C5/D5 | 背景 | 化外之民 |
| A6/B6 | 阵营 | 混乱善良 |
| C6/D6 | 经验值 | 0 |
| A7/B7 | 子职 | (3级选择) |
| C7/D7 | 战斗风格 | 对决 |

**注意**: 子职在3级时选择，1-2级时填写"(3级选择)"即可。

---

### 2. 六维属性区 (A9-D16)

```
A9: 【六维属性】(蓝色标题)
A10: 属性 | B10: 数值 | C10: 调整值(公式自动计算)
A11: 力量 | B11: [填写] | C11: =FLOOR(B11/2-5,1)
A12: 敏捷 | B12: [填写] | C12: =FLOOR(B12/2-5,1)
A13: 体质 | B13: [填写] | C13: =FLOOR(B13/2-5,1)
A14: 智力 | B14: [填写] | C14: =FLOOR(B14/2-5,1)
A15: 感知 | B15: [填写] | C15: =FLOOR(B15/2-5,1)
A16: 魅力 | B16: [填写] | C16: =FLOOR(B16/2-5,1)
```

**使用方法**: 在B列填入属性值(3-20)，C列自动计算调整值。

---

### 3. 战斗数据区 (F3-I9)

| 单元格 | 项目 | 说明 |
|--------|------|------|
| F4/G4 | 最大HP | 根据职业生命骰+体质调整值计算 |
| F5/G5 | 当前HP | 战斗中实时更新 |
| F6/G6 | 临时HP | 法术或特性提供的临时生命值 |
| F7/G7 | AC | 10 + 敏捷调整值 + 护甲加值 |
| F8/G8 | 先攻 | 自动引用敏捷调整值(C12) |
| F9/G9 | 速度 | 种族基础速度(半兽人30尺) |

**公式**: 先攻 = 敏捷调整值 (引用C12)

---

### 4. 豁免检定区 (F11-I17)

```
F11: 【豁免检定】(蓝色标题)
F12: 豁免 | G12: 熟练 | H12: 加值(公式)
F13: 力量 | G13: O/X  | H13: =C11+IF(G13="O",2,0)
F14: 敏捷 | G14: O/X  | H14: =C12+IF(G14="O",2,0)
...
```

**熟练标记**: 在G列填入"O"(熟练)或"X"(不熟练)
- 战士: 力量、体质豁免熟练
- 其他职业根据PHB确定

---

### 5. 子职特性区 (A18-F35)

```
A18: 【子职特性】(橙色标题)
A19: 子职: | B19: [填写] | C19: 勇士/战斗大师/奥法骑士

A20: 等级 | B20: 特性名称 | C20: 描述
A21: 3级  | B21: 强袭     | C21: 武器攻击19-20暴击
...
```

**战士子职选项**:
- **勇士**: 扩大暴击范围、运动员、额外战斗风格
- **战斗大师**: 卓越骰(d8)、战法(3种)、知己知彼
- **奥法骑士**: 法术施放(2戏法+3法术)、武器绑定

**填写方式**:
1. 在B19填入选择的子职名称
2. 根据子职，填写对应的特性列表（可参考下方完整数据）

---

### 6. 种族特性区 (H18-L35)

```
H18: 【种族特性】(紫色标题)
H19: 种族: | I19: [填写]

H20: 特性名称 | I20: 描述
H21: 黑暗视觉 | I21: 60尺黑暗视觉
...
```

**常见种族特性**:

| 种族 | 特性 |
|------|------|
| 半兽人 | 黑暗视觉、不屈、凶恶攻击、凶恶外观 |
| 精灵 | 黑暗视觉、敏锐感官、妖精血统、出神 |
| 矮人 | 黑暗视觉、矮人韧性、石中精妙 |
| 人类 | 全属性+1 |
| 半身人 | 幸运、勇敢、半身人灵巧 |

---

### 7. 职业基础特性区 (A37-F55)

```
A37: 【职业基础特性】(绿色标题)
A38: 等级 | B38: 特性名称 | C38: 描述
A39: 1级  | B39: 战斗风格 | C39: 选择一种战斗风格
A40: 1级  | B40: 回气     | C40: 恢复1d10+等级HP
...
```

**战士基础特性（1-20级）**:

| 等级 | 特性 | 说明 |
|------|------|------|
| 1 | 战斗风格 | 选择一种战斗风格 |
| 1 | 回气 | 附赠动作恢复1d10+等级HP，1次/短休或长休 |
| 2 | 动作如潮 | 自己回合内多一个动作，1次/短休或长休 |
| 5 | 额外攻击 | 攻击动作可攻击两次 |
| 9 | 不屈 | 重掷失败的豁免检定，1次/长休 |
| 13 | 不屈+ | 2次/长休 |
| 17 | 不屈++/动作如潮+ | 3次/长休；动作如潮2次/短休 |
| 20 | 额外攻击++ | 攻击动作可攻击四次 |

---

### 8. 装备区 (H37-L45)

| 单元格 | 项目 | 示例 |
|--------|------|------|
| H38/I38 | 主手武器 | 巨斧(1d12) |
| H39/I39 | 副手/盾牌 | 盾牌(+2AC) |
| H40/I40 | 护甲 | 链甲(AC16) |
| H41/I41 | 远程武器 | 长弓(1d8) |
| H42/I42 | 法术焦点 | 奥术法器 |

---

## 🎨 颜色编码

| 颜色 | 区域 | RGB |
|------|------|-----|
| 🔵 蓝色 | 主要数据区 | #4472C4 |
| 🟢 绿色 | 基础特性 | #70AD47 |
| 🟠 橙色 | 子职特性 | #ED7D31 |
| 🟣 紫色 | 种族特性 | #7030A0 |

---

## 🚀 快速入门

### 创建新角色步骤：

1. **复制模板**
   ```bash
   cp character_sheet_template.xlsx my_character.xlsx
   ```

2. **填写基础信息** (A3-E7)
   - 角色名、种族、职业、等级等

3. **设定六维属性** (B11-B16)
   - 使用购点法或骰点决定属性值
   - 调整值自动计算

4. **标记豁免熟练** (G13-G18)
   - 根据职业确定熟练豁免
   - 填入"O"表示熟练

5. **选择战斗风格** (D7)
   - 战士1级选择：对决/双武器/箭术/防御/守护/重武器

6. **规划子职** (B19)
   - 1-2级填写"(3级选择)"
   - 3级时选择：勇士/战斗大师/奥法骑士

7. **记录种族特性** (H18-L35)
   - 根据PHB填写种族特性

8. **填写装备** (H37-L45)
   - 根据起始装备和购买记录填写

---

## 📊 公式说明

### 调整值计算
```excel
=FLOOR(属性值/2-5, 1)
```
- 10-11 → 0
- 12-13 → +1
- 14-15 → +2
- 16-17 → +3
- 18-19 → +4
- 20 → +5

### 豁免加值计算
```excel
=调整值 + IF(熟练="O", 熟练加值, 0)
```
- 熟练加值 = 1-4级+2, 5-8级+3, 9-12级+4, 13-16级+5, 17-20级+6

### 先攻
```excel
=敏捷调整值
```
- 可根据特性添加其他加值

---

## 🔧 自定义修改

### 添加新职业
1. 复制"职业基础特性"区域
2. 根据PHB修改特性列表
3. 调整生命骰公式

### 添加新子职
1. 参考"子职特性"区域格式
2. 根据PHB填写子职特性
3. 按等级排序

### 添加新种族
1. 参考"种族特性"区域格式
2. 根据PHB填写种族特性
3. 修改速度和属性加值

---

## 📌 注意事项

1. **不要删除公式单元格** - 会破坏自动计算
2. **属性值范围** - 3-20（正常创建范围8-15，魔法可到20+）
3. **熟练标记** - 只能填"O"或"X"
4. **子职选择时机** - 战士3级，其他职业参考PHB
5. **定期保存** - Excel自动计算可能会有延迟

---

## 📚 参考资源

- 规则书: `references/core-rules/phb.md`
- 子职数据: `scripts/character_parser.py` 中的 SUBCLASS_DATA
- 种族数据: `scripts/character_parser.py` 中的 RACIAL_TRAITS

---

*模板版本: v2.0*  
*更新日期: 2026-02-10*  
*适用规则: D&D 5e PHB*
